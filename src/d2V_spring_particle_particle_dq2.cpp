#include <d2V_spring_particle_particle_dq2.h>

void d2V_spring_particle_particle_dq2(Eigen::Ref<Eigen::Matrix66d> H, Eigen::Ref<const Eigen::Vector3d> q0,  Eigen::Ref<const Eigen::Vector3d> q1, double l0, double stiffness) {
    H = Eigen::Matrix66d();
    H.setZero();
    double q_1,q_2,q_3,q_4,q_5,q_6;
    q_1 = q0[0];
    q_2 = q0[1];
    q_3 = q0[2];
    q_4 = q1[0];
    q_5 = q1[1];
    q_6 = q1[2];

    H(0,0) = (stiffness*pow(q_1*2.0-q_4*2.0,2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)-stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+(stiffness*pow(q_1*2.0-q_4*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(0,1) = (stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(0,2) = (stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(0,3) = (stiffness*pow(q_1*2.0-q_4*2.0,2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*pow(q_1*2.0-q_4*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(0,4) = (stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(0,5) = (stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(1,0) = (stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(1,1) = (stiffness*pow(q_2*2.0-q_5*2.0,2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)-stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+(stiffness*pow(q_2*2.0-q_5*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(1,2) = (stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(1,3) = (stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(1,4) = (stiffness*pow(q_2*2.0-q_5*2.0,2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*pow(q_2*2.0-q_5*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(1,5) = (stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(2,0) = (stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(2,1) = (stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(2,2) = (stiffness*pow(q_3*2.0-q_6*2.0,2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)-stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+(stiffness*pow(q_3*2.0-q_6*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(2,3) = (stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(2,4) = (stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(2,5) = (stiffness*pow(q_3*2.0-q_6*2.0,2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*pow(q_3*2.0-q_6*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(3,0) = (stiffness*pow(q_1*2.0-q_4*2.0,2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*pow(q_1*2.0-q_4*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(3,1) = (stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(3,2) = (stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(3,3) = (stiffness*pow(q_1*2.0-q_4*2.0,2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)-stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+(stiffness*pow(q_1*2.0-q_4*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(3,4) = (stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(3,5) = (stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(4,0) = (stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(4,1) = (stiffness*pow(q_2*2.0-q_5*2.0,2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*pow(q_2*2.0-q_5*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(4,2) = (stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(4,3) = (stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_1*2.0-q_4*2.0)*(q_2*2.0-q_5*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(4,4) = (stiffness*pow(q_2*2.0-q_5*2.0,2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)-stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+(stiffness*pow(q_2*2.0-q_5*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(4,5) = (stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(5,0) = (stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(5,1) = (stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(5,2) = (stiffness*pow(q_3*2.0-q_6*2.0,2.0)*(-1.0/4.0))/(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))-(stiffness*pow(q_3*2.0-q_6*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(5,3) = (stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_1*2.0-q_4*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(5,4) = (stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)+(stiffness*(q_2*2.0-q_5*2.0)*(q_3*2.0-q_6*2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;
    H(5,5) = (stiffness*pow(q_3*2.0-q_6*2.0,2.0))/(q_1*(q_1-q_4)*4.0+q_2*(q_2-q_5)*4.0-q_4*(q_1-q_4)*4.0+q_3*(q_3-q_6)*4.0-q_5*(q_2-q_5)*4.0-q_6*(q_3-q_6)*4.0)-stiffness*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6))+(stiffness*pow(q_3*2.0-q_6*2.0,2.0)*(l0-sqrt(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6)))*1.0/pow(q_1*(q_1-q_4)+q_2*(q_2-q_5)-q_4*(q_1-q_4)+q_3*(q_3-q_6)-q_5*(q_2-q_5)-q_6*(q_3-q_6),3.0/2.0))/4.0;

}